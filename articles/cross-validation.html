<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EBMAhelper">
<title>EBMA cross-validation • EBMAhelper</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="EBMA cross-validation">
<meta property="og:description" content="EBMAhelper">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EBMAhelper</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/cross-validation.html">EBMA cross-validation</a>
    <a class="dropdown-item" href="../articles/ebma.html">EBMAhelper</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="cross-validation_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>EBMA cross-validation</h1>
                        <h4 data-toc-skip class="author">Andreas Beger</h4>
            
            <h4 data-toc-skip class="date">2022-02-17</h4>
      
      
      <div class="d-none name"><code>cross-validation.Rmd</code></div>
    </div>

    
    
<p>The hypothesis this note will hopefully eventually check is whether cross-validation can reduce overfitting in EBMA. Right now it only demonstrates overfitting for the demo example.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyr.tidyverse.org" class="external-link">"tidyr"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://forcats.tidyverse.org" class="external-link">"forcats"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"EBMAforecast"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"EBMAhelper"</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="continuous-outcome-demo-presidential-forecasts">Continuous outcome demo: presidential forecasts<a class="anchor" aria-label="anchor" href="#continuous-outcome-demo-presidential-forecasts"></a>
</h2>
<p>The first demo example consists of forecasts for vote share in US presidential elections. I’m using the demo example here, but will use 3 instead of 1 data point as the holdout test set.</p>
<p>To assess performance, I will look at calibration and test period MAE and RMSE for the component models, EBMA, and a baseline simple average ensemble. Relevant questions:</p>
<ul>
<li>Does EBMA perform better than the component models?</li>
<li>Does EBMA perform better than a simple average?</li>
<li>Overfitting: how much performance decline is there between calibration and test?</li>
</ul>
<p>Since there is relatively little data, we can use cross-validation to obtain the performance statistics. With 15 rows total and leaving 3 out, there are 455 distinct calibration/test splits. run them all:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">presidentialForecast</span><span class="op">)</span>

<span class="va">x_data</span> <span class="op">&lt;-</span> <span class="va">presidentialForecast</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span>
<span class="va">y_data</span> <span class="op">&lt;-</span> <span class="va">presidentialForecast</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span>

<span class="co"># 15 choose 3 for train/test split; get all unique combinations</span>
<span class="va">all_splits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, <span class="fl">3</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">all_splits</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="co">#cat(paste0(i, "."))</span>
  <span class="co">#if (i %% 10 == 0) cat("\n")</span>
  
  <span class="co"># Split 12/3 for calibration/test</span>
  <span class="va">test_idx</span>  <span class="op">&lt;-</span> <span class="va">all_splits</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>
  <span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, <span class="va">all_splits</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
  
  <span class="co"># Calibrate EBMA</span>
  <span class="va">ebma_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebma.html">ebma</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y_data</span><span class="op">[</span><span class="va">train_idx</span><span class="op">]</span>, x <span class="op">=</span> <span class="va">x_data</span><span class="op">[</span><span class="va">train_idx</span>, <span class="op">]</span>,
                   model_type <span class="op">=</span> <span class="st">"normal"</span>, 
                   useModelParams <span class="op">=</span> <span class="cn">FALSE</span>, tol <span class="op">=</span> <span class="fl">0.0001</span>, const <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  
  <span class="co"># Save calibration/test RMSE/MAE for each model</span>
  <span class="va">df</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ebma_fit</span>, period<span class="op">=</span><span class="st">"calibration"</span>, showCoefs<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">summaryData</span>
  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Period <span class="op">=</span> <span class="st">"calib"</span>, Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, <span class="va">df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rmse"</span>, <span class="st">"mae"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
  <span class="va">df</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ebma_fit</span>, period<span class="op">=</span><span class="st">"test"</span>, showCoefs<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">summaryData</span>
  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">out</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Period <span class="op">=</span> <span class="st">"test"</span>, Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, <span class="va">df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rmse"</span>, <span class="st">"mae"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  
  <span class="co"># Just average</span>
  <span class="va">simple_avg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">x_data</span><span class="op">)</span>
  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"calib"</span>, <span class="st">"test"</span><span class="op">)</span>,
                    Model <span class="op">=</span> <span class="st">"Simple avg"</span>, 
                    rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">simple_avg</span><span class="op">[</span><span class="va">train_idx</span><span class="op">]</span> <span class="op">-</span> <span class="va">y_data</span><span class="op">[</span><span class="va">train_idx</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">simple_avg</span><span class="op">[</span><span class="va">test_idx</span><span class="op">]</span>  <span class="op">-</span> <span class="va">y_data</span><span class="op">[</span><span class="va">test_idx</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
                    <span class="op">)</span>,
                    mae <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
                      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">simple_avg</span><span class="op">[</span><span class="va">train_idx</span><span class="op">]</span> <span class="op">-</span> <span class="va">y_data</span><span class="op">[</span><span class="va">train_idx</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
                      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">simple_avg</span><span class="op">[</span><span class="va">test_idx</span><span class="op">]</span>  <span class="op">-</span> <span class="va">y_data</span><span class="op">[</span><span class="va">test_idx</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
                    <span class="op">)</span><span class="op">)</span>
  
  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">fit</span><span class="op">)</span>
  <span class="va">out</span><span class="op">$</span><span class="va">index</span> <span class="op">&lt;-</span> <span class="va">i</span>
  
  <span class="va">output</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">#&gt; Model weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithmModel weights estimated using EM algorithm</span>
<span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">output</span><span class="op">)</span></code></pre></div>
<p>Here are the results, ordered from best test RMSE to worse test RMSE.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Average RMSE/MAE fit by model</span>
<span class="va">output</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">stat</span>, <span class="va">value</span>, <span class="va">rmse</span><span class="op">:</span><span class="va">mae</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Model</span>, <span class="va">Period</span>, <span class="va">stat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    Period <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html" class="external-link">fct_recode</a></span><span class="op">(</span><span class="va">Period</span>, Calib <span class="op">=</span> <span class="st">"calib"</span>, Test <span class="op">=</span> <span class="st">"test"</span><span class="op">)</span>,
    stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">stat</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span><span class="va">stat</span>, <span class="va">Period</span>, <span class="va">stat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span><span class="va">stat</span>, <span class="va">mean</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Test_RMSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Model</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with</a></span><span class="op">(</span><span class="st">"MAE"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with</a></span><span class="op">(</span><span class="st">"RMSE"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'Model', 'Period'. You can override using</span>
<span class="co">#&gt; the `.groups` argument.</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Model</th>
<th align="right">Calib_MAE</th>
<th align="right">Test_MAE</th>
<th align="right">Calib_RMSE</th>
<th align="right">Test_RMSE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Simple avg</td>
<td align="right">0.96</td>
<td align="right">0.96</td>
<td align="right">1.28</td>
<td align="right">1.17</td>
</tr>
<tr class="even">
<td align="left">EBMA</td>
<td align="right">1.17</td>
<td align="right">1.62</td>
<td align="right">1.43</td>
<td align="right">1.71</td>
</tr>
<tr class="odd">
<td align="left">Lewis-Beck</td>
<td align="right">1.42</td>
<td align="right">1.39</td>
<td align="right">1.69</td>
<td align="right">1.72</td>
</tr>
<tr class="even">
<td align="left">Hibbs</td>
<td align="right">1.38</td>
<td align="right">2.01</td>
<td align="right">1.87</td>
<td align="right">2.14</td>
</tr>
<tr class="odd">
<td align="left">Abramowitz</td>
<td align="right">1.34</td>
<td align="right">2.24</td>
<td align="right">1.60</td>
<td align="right">2.28</td>
</tr>
<tr class="even">
<td align="left">EWT2C2</td>
<td align="right">2.05</td>
<td align="right">1.76</td>
<td align="right">2.69</td>
<td align="right">2.29</td>
</tr>
<tr class="odd">
<td align="left">Fair</td>
<td align="right">1.82</td>
<td align="right">2.29</td>
<td align="right">2.20</td>
<td align="right">2.36</td>
</tr>
<tr class="even">
<td align="left">Campbell</td>
<td align="right">1.62</td>
<td align="right">3.25</td>
<td align="right">2.26</td>
<td align="right">4.05</td>
</tr>
</tbody>
</table>
<ul>
<li>EBMA does better than the input models on both MAE and RMSE and in both the calibration and test sets.</li>
<li>A simple average ensemble does better than EBMA, except for head on head in calibration RMSE.</li>
<li>Both the MAE and RMSE are about 0.2 higher for the test set than calibration set. Who nows whether that is a lot of overfitting, but in any case it is enough to push EBMA from “competitive with a simple average” in the in-sample predictions to non-competitive in the out-of-sample test predictions.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Andreas Beger.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
